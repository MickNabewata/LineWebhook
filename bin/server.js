"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var createError=require("http-errors"),express=require("express"),helmet=require("helmet"),csurf=require("csurf"),path=require("path"),cookieParser=require("cookie-parser"),line=require("@line/bot-sdk"),logger=require("morgan"),favicon=require("serve-favicon"),config=require("config"),index_1=require("./routes/index"),example_1=require("./routes/api/example"),message_1=require("./routes/api/message"),App=function(){this.expressApp=express(),this.csrfProtection=csurf({cookie:!0}),this.lineConfig=line.middleware({channelAccessToken:config.get("lineAt.token"),channelSecret:config.get("lineAt.secret")}),this.expressApp.set("views",path.join(__dirname,"views")),this.expressApp.set("view engine","jade"),this.expressApp.use(logger("dev")),this.expressApp.use(express.json()),this.expressApp.use(express.urlencoded({extended:!1})),this.expressApp.use(cookieParser()),this.expressApp.use(favicon(__dirname+"/public/images/favi.ico")),this.expressApp.use(helmet()),this.expressApp.use("/",(new index_1.default).Router),this.expressApp.use("/api/example",(new example_1.default).Router),this.expressApp.use("/webhook",(new message_1.default).Router),this.expressApp.use(function(e,s,r){r(createError(404))}),this.expressApp.use(function(e,s,r,i){r.locals.message=e.message,r.locals.error="development"===s.this.expressApp.get("env")?e:{},r.status(e.status||500),r.render("error")})};exports.default=App;