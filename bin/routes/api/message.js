"use strict";var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)};return function(e,t){function s(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}();Object.defineProperty(exports,"__esModule",{value:!0});var apiBase_1=require("../apiBase"),config=require("config"),httpUtil_1=require("../../utils/httpUtil"),Example=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.postEvent=function(e,t,s){if(e.body&&e.body.events&&0<e.body.events.length){var o=e.body.events[0];switch(o.type){case"message":this.receiveMessage(o,t);break;case"beacon":case"follow":case"join":case"leave":case"memberJoined":case"memberLeft":case"postback":case"unfollow":default:t.statusCode=200,t.end()}}else t.statusCode=400,t.json("events is required.")},t.prototype.postCheck=function(e){return e.body?"events"in e.body?null:"request body events is required.":"request body is required."},t.prototype.receiveMessage=function(e,t){var s,o;if(e&&e.message&&e.message.type)switch(e.message.type){case"text":s=config.get("worker.text"),o=e.message;break;case"image":case"video":s="",o=e.message}""!=s?this.doRequest(s,o,t):(t.statusCode=200,t.end())},t.prototype.doRequest=function(e,t,o){httpUtil_1.default.post(e,{json:!0,body:t,headers:{"Content-Type":"application/json"}},function(e,t,s){o.statusCode=t.statusCode,o.json(s)})},t}(apiBase_1.default);exports.default=Example;